{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.clearTimeout = exports.dispose = exports.postMessage = exports.init = exports.messagePromises = exports.error = exports.timeout = exports.initPromise = exports.origin = exports.instance = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _deferred = require(\"../utils/deferred\");\n\nvar _constants = require(\"../constants\");\n\nvar _urlUtils = require(\"../utils/urlUtils\");\n\nvar _inlineStyles = _interopRequireDefault(require(\"./inline-styles\"));\n/* eslint-disable import/no-mutable-exports */\n\n\nvar instance;\nexports.instance = instance;\nvar origin;\nexports.origin = origin;\nvar initPromise = (0, _deferred.create)();\nexports.initPromise = initPromise;\nvar timeout = 0;\nexports.timeout = timeout;\nvar error;\n/* eslint-enable import/no-mutable-exports */\n\nexports.error = error;\nvar _messageID = 0; // every postMessage to iframe has its own promise to resolve\n\nvar messagePromises = {};\nexports.messagePromises = messagePromises;\n\nvar init = /*#__PURE__*/function () {\n  var _ref = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee(settings) {\n    var existedFrame, src, manifestString, manifest, onLoad;\n    return _regenerator[\"default\"].wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            exports.initPromise = initPromise = (0, _deferred.create)();\n            existedFrame = document.getElementById('trezorconnect');\n\n            if (existedFrame) {\n              exports.instance = instance = existedFrame;\n            } else {\n              exports.instance = instance = document.createElement('iframe');\n              instance.frameBorder = '0';\n              instance.width = '0px';\n              instance.height = '0px';\n              instance.style.position = 'absolute';\n              instance.style.display = 'none';\n              instance.style.border = '0px';\n              instance.style.width = '0px';\n              instance.style.height = '0px';\n              instance.id = 'trezorconnect';\n            }\n\n            if (settings.env === 'web') {\n              manifestString = settings.manifest ? JSON.stringify(settings.manifest) : 'undefined'; // note: btoa(undefined) === btoa('undefined') === \"dW5kZWZpbmVk\"\n\n              manifest = \"version=\" + settings.version + \"&manifest=\" + encodeURIComponent(btoa(JSON.stringify(manifestString)));\n              src = settings.iframeSrc + \"?\" + manifest;\n            } else {\n              src = settings.iframeSrc;\n            }\n\n            instance.setAttribute('src', src);\n\n            if (settings.webusb) {\n              instance.setAttribute('allow', 'usb');\n            }\n\n            exports.origin = origin = (0, _urlUtils.getOrigin)(instance.src);\n            exports.timeout = timeout = window.setTimeout(function () {\n              initPromise.reject(_constants.ERRORS.TypedError('Init_IframeTimeout'));\n            }, 10000);\n\n            onLoad = function onLoad() {\n              if (!instance) {\n                initPromise.reject(_constants.ERRORS.TypedError('Init_IframeBlocked'));\n                return;\n              }\n\n              try {\n                // if hosting page is able to access cross-origin location it means that the iframe is not loaded\n                var iframeOrigin = instance.contentWindow.location.origin;\n\n                if (!iframeOrigin || iframeOrigin === 'null') {\n                  // eslint-disable-next-line no-use-before-define\n                  handleIframeBlocked();\n                  return;\n                }\n              } catch (e) {// empty\n              }\n\n              var extension; // $FlowIssue chrome is not declared outside\n\n              if (typeof chrome !== 'undefined' && chrome.runtime && typeof chrome.runtime.onConnect !== 'undefined') {\n                chrome.runtime.onConnect.addListener(function () {});\n                extension = chrome.runtime.id;\n              }\n\n              instance.contentWindow.postMessage({\n                type: _constants.IFRAME.INIT,\n                payload: {\n                  settings: settings,\n                  extension: extension\n                }\n              }, origin);\n              instance.onload = undefined;\n            }; // IE hack\n\n\n            if (instance.attachEvent) {\n              instance.attachEvent('onload', onLoad);\n            } else {\n              instance.onload = onLoad;\n            } // inject iframe into host document body\n\n\n            if (document.body) {\n              document.body.appendChild(instance); // eslint-disable-next-line no-use-before-define\n\n              injectStyleSheet();\n            }\n\n            _context.prev = 11;\n            _context.next = 14;\n            return initPromise.promise;\n\n          case 14:\n            _context.next = 20;\n            break;\n\n          case 16:\n            _context.prev = 16;\n            _context.t0 = _context[\"catch\"](11); // reset state to allow initialization again\n\n            if (instance) {\n              if (instance.parentNode) {\n                instance.parentNode.removeChild(instance);\n              }\n\n              exports.instance = instance = null;\n            }\n\n            throw _context.t0;\n\n          case 20:\n            _context.prev = 20;\n            window.clearTimeout(timeout);\n            exports.timeout = timeout = 0;\n            return _context.finish(20);\n\n          case 24:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[11, 16, 20, 24]]);\n  }));\n\n  return function init(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexports.init = init;\n\nvar injectStyleSheet = function injectStyleSheet() {\n  if (!instance) {\n    throw _constants.ERRORS.TypedError('Init_IframeBlocked');\n  }\n\n  var doc = instance.ownerDocument;\n  var head = doc.head || doc.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.setAttribute('type', 'text/css');\n  style.setAttribute('id', 'TrezorConnectStylesheet'); // $FlowIssue\n\n  if (style.styleSheet) {\n    // IE\n    // $FlowIssue\n    style.styleSheet.cssText = _inlineStyles[\"default\"];\n    head.appendChild(style);\n  } else {\n    style.appendChild(document.createTextNode(_inlineStyles[\"default\"]));\n    head.append(style);\n  }\n};\n\nvar handleIframeBlocked = function handleIframeBlocked() {\n  window.clearTimeout(timeout);\n  exports.error = error = _constants.ERRORS.TypedError('Init_IframeBlocked'); // eslint-disable-next-line no-use-before-define\n\n  dispose();\n  initPromise.reject(error);\n}; // post messages to iframe\n\n\nvar postMessage = function postMessage(message, usePromise) {\n  if (usePromise === void 0) {\n    usePromise = true;\n  }\n\n  if (!instance) {\n    throw _constants.ERRORS.TypedError('Init_IframeBlocked');\n  }\n\n  if (usePromise) {\n    _messageID++;\n    message.id = _messageID;\n    messagePromises[_messageID] = (0, _deferred.create)();\n    var promise = messagePromises[_messageID].promise;\n    instance.contentWindow.postMessage(message, origin);\n    return promise;\n  }\n\n  instance.contentWindow.postMessage(message, origin);\n  return null;\n};\n\nexports.postMessage = postMessage;\n\nvar dispose = function dispose() {\n  if (instance && instance.parentNode) {\n    try {\n      instance.parentNode.removeChild(instance);\n    } catch (e) {// do nothing\n    }\n  }\n\n  exports.instance = instance = null;\n  exports.timeout = timeout = 0;\n};\n\nexports.dispose = dispose;\n\nvar clearTimeout = function clearTimeout() {\n  window.clearTimeout(timeout);\n};\n\nexports.clearTimeout = clearTimeout;","map":{"version":3,"names":["_interopRequireDefault","require","exports","__esModule","clearTimeout","dispose","postMessage","init","messagePromises","error","timeout","initPromise","origin","instance","_regenerator","_asyncToGenerator2","_deferred","_constants","_urlUtils","_inlineStyles","create","_messageID","_ref","mark","_callee","settings","existedFrame","src","manifestString","manifest","onLoad","wrap","_callee$","_context","prev","next","document","getElementById","createElement","frameBorder","width","height","style","position","display","border","id","env","JSON","stringify","version","encodeURIComponent","btoa","iframeSrc","setAttribute","webusb","getOrigin","window","setTimeout","reject","ERRORS","TypedError","iframeOrigin","contentWindow","location","handleIframeBlocked","e","extension","chrome","runtime","onConnect","addListener","type","IFRAME","INIT","payload","onload","undefined","attachEvent","body","appendChild","injectStyleSheet","promise","t0","parentNode","removeChild","finish","stop","_x","apply","arguments","doc","ownerDocument","head","getElementsByTagName","styleSheet","cssText","createTextNode","append","message","usePromise"],"sources":["/Users/jjestrella/DNERO_Protocol/dnerowebwallet/node_modules/trezor-connect/lib/iframe/builder.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.clearTimeout = exports.dispose = exports.postMessage = exports.init = exports.messagePromises = exports.error = exports.timeout = exports.initPromise = exports.origin = exports.instance = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _deferred = require(\"../utils/deferred\");\n\nvar _constants = require(\"../constants\");\n\nvar _urlUtils = require(\"../utils/urlUtils\");\n\nvar _inlineStyles = _interopRequireDefault(require(\"./inline-styles\"));\n\n/* eslint-disable import/no-mutable-exports */\nvar instance;\nexports.instance = instance;\nvar origin;\nexports.origin = origin;\nvar initPromise = (0, _deferred.create)();\nexports.initPromise = initPromise;\nvar timeout = 0;\nexports.timeout = timeout;\nvar error;\n/* eslint-enable import/no-mutable-exports */\n\nexports.error = error;\nvar _messageID = 0; // every postMessage to iframe has its own promise to resolve\n\nvar messagePromises = {};\nexports.messagePromises = messagePromises;\n\nvar init = /*#__PURE__*/function () {\n  var _ref = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee(settings) {\n    var existedFrame, src, manifestString, manifest, onLoad;\n    return _regenerator[\"default\"].wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            exports.initPromise = initPromise = (0, _deferred.create)();\n            existedFrame = document.getElementById('trezorconnect');\n\n            if (existedFrame) {\n              exports.instance = instance = existedFrame;\n            } else {\n              exports.instance = instance = document.createElement('iframe');\n              instance.frameBorder = '0';\n              instance.width = '0px';\n              instance.height = '0px';\n              instance.style.position = 'absolute';\n              instance.style.display = 'none';\n              instance.style.border = '0px';\n              instance.style.width = '0px';\n              instance.style.height = '0px';\n              instance.id = 'trezorconnect';\n            }\n\n            if (settings.env === 'web') {\n              manifestString = settings.manifest ? JSON.stringify(settings.manifest) : 'undefined'; // note: btoa(undefined) === btoa('undefined') === \"dW5kZWZpbmVk\"\n\n              manifest = \"version=\" + settings.version + \"&manifest=\" + encodeURIComponent(btoa(JSON.stringify(manifestString)));\n              src = settings.iframeSrc + \"?\" + manifest;\n            } else {\n              src = settings.iframeSrc;\n            }\n\n            instance.setAttribute('src', src);\n\n            if (settings.webusb) {\n              instance.setAttribute('allow', 'usb');\n            }\n\n            exports.origin = origin = (0, _urlUtils.getOrigin)(instance.src);\n            exports.timeout = timeout = window.setTimeout(function () {\n              initPromise.reject(_constants.ERRORS.TypedError('Init_IframeTimeout'));\n            }, 10000);\n\n            onLoad = function onLoad() {\n              if (!instance) {\n                initPromise.reject(_constants.ERRORS.TypedError('Init_IframeBlocked'));\n                return;\n              }\n\n              try {\n                // if hosting page is able to access cross-origin location it means that the iframe is not loaded\n                var iframeOrigin = instance.contentWindow.location.origin;\n\n                if (!iframeOrigin || iframeOrigin === 'null') {\n                  // eslint-disable-next-line no-use-before-define\n                  handleIframeBlocked();\n                  return;\n                }\n              } catch (e) {// empty\n              }\n\n              var extension; // $FlowIssue chrome is not declared outside\n\n              if (typeof chrome !== 'undefined' && chrome.runtime && typeof chrome.runtime.onConnect !== 'undefined') {\n                chrome.runtime.onConnect.addListener(function () {});\n                extension = chrome.runtime.id;\n              }\n\n              instance.contentWindow.postMessage({\n                type: _constants.IFRAME.INIT,\n                payload: {\n                  settings: settings,\n                  extension: extension\n                }\n              }, origin);\n              instance.onload = undefined;\n            }; // IE hack\n\n\n            if (instance.attachEvent) {\n              instance.attachEvent('onload', onLoad);\n            } else {\n              instance.onload = onLoad;\n            } // inject iframe into host document body\n\n\n            if (document.body) {\n              document.body.appendChild(instance); // eslint-disable-next-line no-use-before-define\n\n              injectStyleSheet();\n            }\n\n            _context.prev = 11;\n            _context.next = 14;\n            return initPromise.promise;\n\n          case 14:\n            _context.next = 20;\n            break;\n\n          case 16:\n            _context.prev = 16;\n            _context.t0 = _context[\"catch\"](11);\n\n            // reset state to allow initialization again\n            if (instance) {\n              if (instance.parentNode) {\n                instance.parentNode.removeChild(instance);\n              }\n\n              exports.instance = instance = null;\n            }\n\n            throw _context.t0;\n\n          case 20:\n            _context.prev = 20;\n            window.clearTimeout(timeout);\n            exports.timeout = timeout = 0;\n            return _context.finish(20);\n\n          case 24:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[11, 16, 20, 24]]);\n  }));\n\n  return function init(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexports.init = init;\n\nvar injectStyleSheet = function injectStyleSheet() {\n  if (!instance) {\n    throw _constants.ERRORS.TypedError('Init_IframeBlocked');\n  }\n\n  var doc = instance.ownerDocument;\n  var head = doc.head || doc.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.setAttribute('type', 'text/css');\n  style.setAttribute('id', 'TrezorConnectStylesheet'); // $FlowIssue\n\n  if (style.styleSheet) {\n    // IE\n    // $FlowIssue\n    style.styleSheet.cssText = _inlineStyles[\"default\"];\n    head.appendChild(style);\n  } else {\n    style.appendChild(document.createTextNode(_inlineStyles[\"default\"]));\n    head.append(style);\n  }\n};\n\nvar handleIframeBlocked = function handleIframeBlocked() {\n  window.clearTimeout(timeout);\n  exports.error = error = _constants.ERRORS.TypedError('Init_IframeBlocked'); // eslint-disable-next-line no-use-before-define\n\n  dispose();\n  initPromise.reject(error);\n}; // post messages to iframe\n\n\nvar postMessage = function postMessage(message, usePromise) {\n  if (usePromise === void 0) {\n    usePromise = true;\n  }\n\n  if (!instance) {\n    throw _constants.ERRORS.TypedError('Init_IframeBlocked');\n  }\n\n  if (usePromise) {\n    _messageID++;\n    message.id = _messageID;\n    messagePromises[_messageID] = (0, _deferred.create)();\n    var promise = messagePromises[_messageID].promise;\n    instance.contentWindow.postMessage(message, origin);\n    return promise;\n  }\n\n  instance.contentWindow.postMessage(message, origin);\n  return null;\n};\n\nexports.postMessage = postMessage;\n\nvar dispose = function dispose() {\n  if (instance && instance.parentNode) {\n    try {\n      instance.parentNode.removeChild(instance);\n    } catch (e) {// do nothing\n    }\n  }\n\n  exports.instance = instance = null;\n  exports.timeout = timeout = 0;\n};\n\nexports.dispose = dispose;\n\nvar clearTimeout = function clearTimeout() {\n  window.clearTimeout(timeout);\n};\n\nexports.clearTimeout = clearTimeout;"],"mappings":"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"},"metadata":{},"sourceType":"script"}